# 子模块 Trigger

## 功能描述
Trigger的实现在后端，因为Trigger的一个子特性要求是执行前，需要前端IFU的配合。因此从IFU的角度描述一下对Trigger的理解：

触发器不在调试模式下工作，调试模式可以建立一系列的触发器。当同时分别触发进入调试模式和断点异常时，优先保证进入调试模式的发生。推荐是进入调试模式和生成断点异常，都要发生。触发器可以用于本地调试，即不依赖外部调试器（JTAG），而是通过异常机制来进行调试。触发器通常由用户态或监督态设置，但也支持机器态进行设置（M模式下，开发人员必须清晰的知道自己在干什么）。

触发寄存器仅在机器模式和调试模式下可设置。IFU中的trigger逻辑是为了配合后端实现的Trigger模块，目前来看只涉及到了送往IBuffer的PC对比。有关预译码和指令数据使用目前在IFU中的Trigger还没有支持。目前IFU的Trigger中有4个tdata寄存器，值由后端设置。遍历送入IBuffer的所有PC，根据matchType的匹配规则，进行匹配。在匹配的情况下，还需要判断是tdata.select是否为地址匹配目标，以及是否处于非debug模式，才能确定命中。即使是命中情况下，也还需要根据tdata.timing和tdata.chain以及tdata.action做出综合判断。（分别是触发的时机要求，触发的链式匹配要求，以及触发的动作）

值得一提的是IFU中的触发标记只是预触发标记，并不代表一定会触发。因为IFU中标记的指令不一定会被执行。